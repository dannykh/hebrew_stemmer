import re
from src.parser import Word
from more_itertools import first

from src.parser import load_corpus
import numpy as np

pattern_matchers = ['^(.)(.)(.)ti$', '^(.)(.)(.)t$', '$(.)(.)(.)^', '^(.)(.)(.)h$', '^(.)(.)(.)nw$', '^(.)(.)(.)tm$',
                    '^(.)(.)(.)tn$', '^(.)(.)(.)w$', '^a(.)(.)(.)$', '^t(.)(.)(.)$', '^t(.)(.)(.)i$', '^i(.)(.)(.)$',
                    '^n(.)(.)(.)$', '^t(.)(.)(.)w$', '^t(.)(.)(.)nh$', '^i(.)(.)(.)w$', '^(.)(.)(.)i$', '^(.)(.)(.)nh$',
                    '^n(.)(.)(.)ti$', '^n(.)(.)(.)t$', '^n(.)(.)(.)$', '^n(.)(.)(.)h$', '^n(.)(.)(.)nw$',
                    '^n(.)(.)(.)tm$', '^n(.)(.)(.)tn$', '^n(.)(.)(.)w$', '^t(.)(.)(.)i$', '^t(.)(.)(.)w$',
                    '^n(.)(.)(.)im$', '^n(.)(.)(.)wt$', '^h(.)(.)(.)$', '^h(.)(.)(.)i$', '^h(.)(.)(.)w$',
                    '^h(.)(.)(.)nh$', '^lh(.)(.)(.)$', '^h(.)(.)(.)$', '^h(.)(.)(.)ti$', '^h(.)(.)(.)t$',
                    '^h(.)(.)i(.)$', '^h(.)(.)i(.)h$', '^h(.)(.)(.)nw$', '^h(.)(.)(.)tm$', '^h(.)(.)(.)tn$',
                    '^h(.)(.)i(.)w$', '^a(.)(.)i(.)$', '^t(.)(.)i(.)$', '^t(.)(.)i(.)i$', '^i(.)(.)i(.)$',
                    '^n(.)(.)i(.)$', '^t(.)(.)i(.)w$', '^t(.)(.)i(.)nh$', '^i(.)(.)i(.)w$', '^m(.)(.)i(.)$',
                    '^m(.)(.)i(.)h$', '^m(.)(.)i(.)im$', '^m(.)(.)i(.)wt$', '^h(.)(.)(.)$', '^h(.)(.)i(.)i$',
                    '^h(.)(.)i(.)w$', '^h(.)(.)(.)nh$', '^lh(.)(.)i(.)$', '^h(.)(.)(.)h$', '^h(.)(.)(.)w$',
                    '^m(.)(.)(.)$', '^m(.)(.)(.)t$', '^m(.)(.)(.)im$', '^m(.)(.)(.)wt$', '^l(.)(.)(.)$',
                    '^ht(.)(.)(.)ti$', '^ht(.)(.)(.)t$', '^ht(.)(.)(.)$', '^ht(.)(.)(.)h$', '^ht(.)(.)(.)nw$',
                    '^at(.)(.)(.)$', '^tt(.)(.)(.)$', '^tt(.)(.)(.)i$', '^it(.)(.)(.)$', '^nt(.)(.)(.)$',
                    '^tt(.)(.)(.)w$', '^tt(.)(.)(.)nh$', '^it(.)(.)(.)w$', '^mt(.)(.)(.)$', '^mt(.)(.)(.)t$',
                    '^mt(.)(.)(.)im$', '^mt(.)(.)(.)wt$', '^ht(.)(.)(.)i$', '^ht(.)(.)(.)nh$', '^lht(.)(.)(.)$']

if __name__ == '__main__':
    corpus = load_corpus(r"..\data\corpus.pkl")
    tags_by_template = [
        first(["".join(re.search(patt, morph).groups()) if re.search(patt, morph) else "" for patt in pattern_matchers])
        for morph in map(lambda word: word.root, corpus)]
    print("hey")
